<div class="row">
  <div class = "col-10">
    <div class = "card">
      <h2 class = "card-header"><%= @discussion.title %></h2>
      <div class ="card-body">
        <p><em><medium>
          by <%= @discussion.user.username %>
        </p></em></medium>
        
        <div class="content"><%= markdown(@discussion.content) %></div>
        <% if @discussion.image.present? %>
        <div><%=link_to image_tag(@discussion.image.url(:medium)), @discussion.image.url %></div>
        <% end %>
        <br>
        <% if discussion_author(@discussion) || has_role?(:admin) %>
          <%= link_to 'Edit Discussion', edit_discussion_path(@discussion), class:'btn btn-outline-secondary'%>
          <%= link_to 'Delete', discussion_path(@discussion), method: :delete, data: { confirm: "Delete discussion?" }, class:'btn btn-outline-secondary' %>
        <% end %>
        <% if has_role?(:admin) %>
        <div class="btn btn-outline-secondary">
            <%= link_to  "Approve", approve_fp_discussion_path, :method => :post %>
        </div>
        <% end %>
      </div>
    </div>
    <h5><%= @discussion.replies.count %> Replies</h5>

    <!-- javascript rendering done in create.js.erb file-->
    <div id="discussion-replies">
      <%= render @discussion.replies %>
    </div>
  
    <hr/>
  
    <h3 class="subtitle is-3 has-text-grey">Leave a reply</h3>
    <% if user_signed_in? %>
      <%= render 'replies/form' %>
    <% else %>
    <p>To reply you need to <%= link_to 'login', new_user_session_path %>. Don't have an account?
      <%= link_to 'Sign up', new_user_registration_path %> for one.</p>
    <% end %>
  </div>
  
  <div class = "col-2">
    <%= render 'sidebar' %>
  </div>
  
</div>